!function(e){var t={};function n(s){if(t[s])return t[s].exports;var i=t[s]={i:s,l:!1,exports:{}};return e[s].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,s){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(s,i,function(t){return e[t]}.bind(null,i));return s},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return m}));const s={AFTERBEGIN:"afterbegin",AFTEREND:"afterend",BEFOREEND:"beforeend"},i=(e,t,n)=>{switch(n){case s.AFTERBEGIN:e.prepend(t);break;case s.BEFOREEND:e.append(t)}};class r{constructor(){this._element=null,this._createTemplate=null,this._callback=null}getTemplate(){return this._createTemplate}getElement(){return this._element||(this._element=(e=>{const t=document.createElement("div");return t.innerHTML=e,t.firstElementChild})(this.getTemplate())),this._element}}class a extends r{constructor(e,t){super(),this._element=null,this._allQuantity=e,this._callback={},this._clickHandler=this._clickHandler.bind(this),this._createTemplate=((e,t)=>`<button class="news__button">\n  <span>Новости</span>\n  <span>${e} / ${t} непрочитано</span>\n  <span></span>\n</button>`)(e,t)}setClickHandler(e){this._callback.click=e,this.getElement().addEventListener("click",this._clickHandler)}changeReaded(e){this._qunatity=this.getElement().querySelector("span:not(:first-child)"),this._qunatity.textContent=`${this._allQuantity} / ${e} непрочитано`}_clickHandler(e){e.preventDefault(),this._callback.click(),this.getElement().classList.contains("news__button--opened")?this.getElement().classList.remove("news__button--opened"):this.getElement().classList.add("news__button--opened")}}class o extends r{constructor(){super(),this._element=null,this._createTemplate='<section class="news__container"></section>'}}class l extends r{constructor(){super(),this._createTemplate='<section class="news__feed">\n\n  </section>'}toggleNewsFeed(){this.getElement().classList.contains("news__feed--closed")?this.getElement().classList.remove("news__feed--closed"):this.getElement().classList.add("news__feed--closed")}}const c=e=>e.filter(e=>!1===e.isRead).length,d=(e,t,n,s,i)=>{return`<article class="news__item">\n      <h3>${e}</h3>\n      <div class="news__details">\n        <b>${t}</b>\n        <time datetime="2001-05-15 19:00">${r=n,new Date(r).toLocaleString("ru",{day:"numeric",year:"numeric",month:"long",hour:"2-digit",minute:"2-digit"})}</time>\n        <span>${i?"Прочитано":"Не прочитано"}</span>\n        <button>Читать далее</button>\n        <div class="news__text news__text--closed">\n          ${(e=>e.reduce((e,t)=>e+=`<p>${t}</p>`,""))(s)}\n        </div>\n      </div>\n    </article>`;var r};class h extends r{constructor(e){super(),this._heading=e.heading,this._name=e.name,this._time=e.date,this._isRead=e.isRead,this._text=e.text,this._callback={},this._newsTextContainer=this.getElement().querySelector(".news__text"),this._buttonExpand=this.getElement().querySelector("button"),this._readStatus=this.getElement().querySelector("span"),this._buttonClickHandler=this._buttonClickHandler.bind(this)}getTemplate(){return d(this._heading,this._name,this._time,this._text,this._isRead)}setClickHandler(e){this._callback.click=e,this._buttonExpand.addEventListener("click",this._buttonClickHandler)}_buttonClickHandler(){this._newsTextContainer.classList.contains("news__text--closed")?(this._newsTextContainer.classList.remove("news__text--closed"),this._buttonExpand.textContent="Свернуть",this._isRead||(this._isRead=!0,this._readStatus.textContent="Прочитано",this._callback.click())):(this._newsTextContainer.classList.add("news__text--closed"),this._buttonExpand.textContent="Читать далее")}}class _{constructor(e,t){this._newsItems=t.getNews(),this._isRendered=!1,this._allQuantity=t.getNews().length,this._notReadQuantity=c(t.getNews()),this._newsBlock=e,this._newsContainerComponent=new o,this._buttonComponent=new a(t.getNews().length,c(t.getNews())),this._newsFeedComponent=new l,this._handleNewsButtonClick=this._handleNewsButtonClick.bind(this),this._handleReadNewsClick=this._handleReadNewsClick.bind(this)}_renderContainer(){i(this._newsBlock,this._newsContainerComponent.getElement(),s.AFTERBEGIN)}_renderButton(){i(this._newsContainerComponent.getElement(),this._buttonComponent.getElement(),s.AFTERBEGIN),this._buttonComponent.setClickHandler(this._handleNewsButtonClick)}_renderNews(){this._newsItems.forEach(e=>{const t=new h(e);t.setClickHandler(this._handleReadNewsClick),i(this._newsFeedComponent.getElement(),t.getElement(),s.BEFOREEND)}),i(this._newsContainerComponent.getElement(),this._newsFeedComponent.getElement(),s.BEFOREEND)}init(){this._renderContainer(),this._renderButton()}_handleNewsButtonClick(){this._isRendered?this._newsFeedComponent.toggleNewsFeed():(this._renderNews(),this._isRendered=!0)}_handleReadNewsClick(){this._notReadQuantity--,this._buttonComponent.changeReaded(this._notReadQuantity)}}const u=[{id:0,heading:"Почему не цветет декабрист – 5 причин плохого настроения у рождественского кактуса",name:"Александра Иванова",isRead:!1,date:"2020-12-04T17:13:50.157Z",text:["Цветущий декабрист когда-то украшал подоконники во многих советских домах, затем мода на зигокактусы пошла на убыль, но не исчезла – и теперь энтузиасты выводят даже собственные разновидности в домашних условиях. А вот у начинающих цветоводов с декабристом зачастую возникают проблемы. Эксперты татарстанского клуба «Зеленая грядка» подготовили ряд полезных советов и интересную историческую справку с обзором красивейших разновидностей.","Английский ученый-ботаник Аллан Каннингем, собирающий коллекцию уникальных растений, вывез декабриста в Европу. Французский селекционер Фредерик Шлюмберже, заинтересовавшийся удивительным растением, доказал, что цветок относится к семейству кактусовых. Ботаник Чарльз Лемэр, посвятивший себя изучению кактусов и суккулентов, назвал цветок в честь своего коллеги кактусом Шлюмбергега.","Декабрист комфортно себя чувствует при температуре от + 19 …+25°C. Благополучие цветка зависит от регулярности поливов. Увлажняют их умеренно каждую неделю по 1 разу, если необходимо, то чаще. Нельзя допускать пересыхания земляного кома. Растение любит влажный воздух.","Декабрист – красивое и долгоживущие растение, которое при правильном уходе будет радовать рождественскими цветами на протяжении 20 лет."]},{id:1,heading:"В каком состоянии озимые Ставрополья на начало декабря 2020",name:"Алина Ткачева",isRead:!1,date:"2020-12-04T17:13:50.157Z",text:["По состоянию на 3 декабря, на кочубеевских полях, засеянных озимыми зерновыми культурами, уже взошло 61,1 тыс. га или 97,5%. Из них в хорошем состоянии – 14,3 тыс. га, в удовлетворительном – 32,2 тыс. га и в плохом – 14,6 тыс. га.","«Всего на Ставрополье из посеянных 2 млн га взошло 30% озимых культур. Сложившиеся погодные условия способствуют появлению всходов на всей посевной площади в течение 10-12 дней», – отметил первый заместитель министра сельского хозяйства Ставропольского края Вячеслав Дридигер."]},{id:2,heading:"Куда ветер дует: время определиться с ветрозащитой для пастбищного скота",name:"Алина Ткачева",isRead:!1,date:"2020-04-12T14:48:00.000Z",text:["«Если производители говядины хотят иметь здоровых и продуктивных животных, крайне важно обеспечить их защиту от ветра», - говорит Дженифер Хейден, специалист по животноводству и распространению кормов из правительства Саскачевана.","В то время как естественные ветрозащитные полосы - в основном деревья и кустарники – бесплатны, если они уже существуют, переносные искусственные ограждения дают больше контроля при зимовке стада. Кроме того, созданные ветрозащитные полосы могут быть оградой для выпаса скота на том месте, где есть дефицит питательных веществ в почве: навоз является ценным органическим удобрением.","«В конце концов, каждый должен выяснить, что лучше всего подойдет в каждом конкретном случае. У каждого свои цели и разные обстоятельства, чтобы принять решение о лучшем типе ветрозащиты – все должно основываться на благополучии животных и экономических соображениях», заключила Хейден."]}];class w{constructor(){this._news=[]}setNews(e){this._news=e}getNews(){return this._news}}class m{constructor(e){const{container:t,type:n,source:s}=e;this._newsBlock=document.querySelector("#"+t),this._type=n,this._source=s,this._newsModel=new w,this._init()}_init(){if(!this._newsBlock)throw new Error("Выбран несуществующий контейнер");switch(this._type){case"server":this._startFromServer();break;case"mocks":this._startWithMocks(u);break;default:throw new Error("Некорректно указан тип работы")}}_startFromServer(){fetch(this._source).then(e=>{if(200!==e.status)throw new Error("Ошибка загрузки данных с сервера: "+e.status);e.json().then(e=>{this._newsModel.setNews(e),this._renderPresenter()})}).catch(e=>{throw new Error("Произошла неизвестная ошибка, код ошибки:"+e)})}_startWithMocks(e){this._newsModel.setNews(e),this._renderPresenter()}_renderPresenter(){new _(this._newsBlock,this._newsModel).init()}}window.NewsWidget=m}]);