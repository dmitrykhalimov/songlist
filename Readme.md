# News Widget

Виджет отображающий новостную ленту.

[Ссылка на проект на сервере](http://dkha.site/projects/widget)

---
#### Технологии

_`ES2015+`, `MVP`, `Fetch API`, `Webpack`, `БЭМ`, `Gulp`, `Sass`._

#### Структура репозитория

* **build** - итоговая сборка, html-файл создан вручную, css и js копируются при помощи команд (см. ниже)
* **markup** - итоговая верстка, в нее Gulp копирует собранный проект
* **source** - исходные файлы
* **source/markup** - файлы проекта Sass/Gulp
* **source/js** - файлы JavaScript Webpack

#### Команды репозитория

* Установка зависимостей - `npm i` 
* Запуск сервера верстки - `npm run markup-start` (порт `3000`)
* Сборка верстки - `npm run markup-build` (сборка собирается в `/markup`)
* Перенос news-widget.css в папку `/build` - `npm run markup-copy`

* Запуск модуля - `npm run js-start`(используется папка `/build`, порт `3005`)
* Сборка модуля - `npm run js-build` (сборка собирается в `/build` + копируется `news-widget.css` из `/markup`)
* Сборка модуля в режиме production - `npm run js-build-prod` (сборка собирается в `/build` + копируется `news-widget.css` из `/markup`)

* Запуск тестирования - `npm run test`


#### Подключение и инициализация

Для подключения виджета в HTML-файл необходимо импортировать файл стиля и файл js

```
<link href="css/news-widget.css" rel="stylesheet">
<script src="news-widget.js"></script>
```
Для инициализации необходимо создать новый экземпляр виджета, в качестве аргумента необходимо передать объект содержащий данные для инициализации.
```
<script>
    const newsWidgetData = new NewsWidget({
        container: "news",
        type: "server",
        source: "https://run.mocky.io/v3/f713c246-2a14-4520-8468-42de76929ed7"
    });
</script>
```
Конструктор принимает в себя 3 параметра:
- **container** - id-контейнера, 
- **type** - типа загрузки данных: `server` или `mock`, 
- **source** - адрес сервера. 

В режиме `mock`, не требуется указание сервера, данные загружаются из самого виджета (файл `source/mock.js`)

Виджет наследует шрифт от контейнера в котором он размещен. Предполагается использование шрифта без засечек. Я использовал шрифт Rubik, который добавлен в папку `\fonts` проекта. 

#### Принцип работы

После инициализации отрисовывается кнопка-иконка (контейнер `NewsContainer` и `MainButton`), содержащая количество загруженных новостей и количество непрочитанных из них. По ее нажатию происходит отрисовка списка новостей (контейнер `NewsFeed` и элементы `NewsItem`). До нажатия на кнопку, отрисовка не происходит (т.е. не используется конструкция visually-hidden или display: none) в целях улучшения производительности.

По нажатию на кнопку `Читать далее` разворачивается новость, а кнопка меняет значение на `Свернуть`. Также меняется статус новости на `Прочитано`, и уменьшается счетчик прочитанных новостей. 

Кнопка адаптивна: брейкпоинт мобильной версии `768px`, минимальная ширина `320px`. Виджет занимает 100% контейнера.

#### Дополнительные уточнения

Для реализации виджета я выбрал паттерн MVP т.к. в случае динамически генерируемых новостей он показался мне оптимальным (если бы не необходимость использования чистого JS, я бы использовал React).

В задании было указано, что один контейнер новости должен содержать ссылку на подробности. Для того чтобы реализовать возможность отметки прочитанных новостей, мне показалось логичным вместо ссылки добавить кнопку с раскрывающейся новостью. При необходимости, кнопка может быть заменена ссылкой, достаточно заменить `button` на `a`, и убрать обработчики.

Отметки "прочитано" и "количество прочитанных" изменяются путем изменения самого элемента через `.textContent`, при неизменной модели. Это мне кажется не совсем оптимальным (правильнее - реализовать изменение модели и перерисовку новости (replaceChild) и кнопки со статистикой), но так как такого требования в ТЗ нет, я написал такую эмуляцию.

Т.к. данные не изменяются, можно было бы обойтись без модели, загружая данные прямо из точки входа (`main.js`), но из эстетических соображений я ее все-таки добавил.

Сетка реализована через CSS-Grid.

#### TODO

* Реализовать через localStorage хранение просмотренных новостей
* Добавить кнопку-переключатель "скрывать прочитанные"
* Предусмотреть возможность стилизации контейнера через аргументы передаваемые при вызове (цвет, центровка, фон)
* Добавить ограничение количества загруженных новостей/предусмотреть кнопку 
"Показать еще"
* Реализовать адаптивность не через @media, а через JS (сейчас, если задать размер виджета менее 768px при десктопном разрешении, верстка сломается)
